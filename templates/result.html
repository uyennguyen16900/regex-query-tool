{% extends 'base.html' %}

{% block content %}
  <p>{{ matches|length }} matches</p>

  {% set i = namespace(a=0) %}
  {% if indices|length == 0 %}
    {% for word in test_str -%}
      {{ word }}
    {%- endfor %}
  {% else %}
    {% for word in test_str -%}
      {%- if loop.index0 >= indices[i.a][0] and loop.index0 <= indices[i.a][1] -%}
        <span style="background-color:#abeaff;color:#0286b3">
          {{- word -}}
        </span>
      {%- elif i.a < (indices|length) - 1 and loop.index0 == indices[i.a][1] + 1 -%}
        {% set i.a = i.a + 1 %}
      {%- else -%}
        {{ word }}
      {%- endif -%}
    {%- endfor %}
  {% endif %}

  <!-- scrollspy -->
  <div class="col-3">
    <div data-spy="scroll" data-target="#myScrollspy" data-offset="10"
    style="height:200px;overflow-y: scroll;padding:5px; border: 1px solid #ccc;">
      {% for match in matches %}
        <h5>Match {{ loop.index }}</h5>
        <p><span style="color:#9d9d9e">{{indices[loop.index0]}} </span>{{ match }}</p>
      {% endfor %}
    </div>
  </div>

{% endblock %}
